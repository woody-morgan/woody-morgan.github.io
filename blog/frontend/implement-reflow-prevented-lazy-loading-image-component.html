<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Implement Reuseable &lt;img/&gt;</title><meta name="robots" content="follow, index"/><meta name="description" content="CLS(Cumulative Layout Shift)를 줄이고 렌더링 성능을 개선한 &lt;img/&gt; 컴포넌트 제작기"/><meta property="og:url" content="https://woody-morgan.github.io//blog/frontend/implement-reflow-prevented-lazy-loading-image-component"/><meta property="og:type" content="article"/><meta property="og:site_name" content="woody-morgan.github.io"/><meta property="og:description" content="CLS(Cumulative Layout Shift)를 줄이고 렌더링 성능을 개선한 &lt;img/&gt; 컴포넌트 제작기"/><meta property="og:title" content="Implement Reuseable &lt;img/&gt;"/><meta property="og:image" content="https://woody-morgan.github.io//static/images/img.jpeg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="Implement Reuseable &lt;img/&gt;"/><meta name="twitter:description" content="CLS(Cumulative Layout Shift)를 줄이고 렌더링 성능을 개선한 &lt;img/&gt; 컴포넌트 제작기"/><meta name="twitter:image" content="https://woody-morgan.github.io//static/images/img.jpeg"/><meta property="article:published_time" content="2022-08-01T00:00:00.000Z"/><link rel="canonical" href="https://woody-morgan.github.io//blog/frontend/implement-reflow-prevented-lazy-loading-image-component"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://woody-morgan.github.io//blog/frontend/implement-reflow-prevented-lazy-loading-image-component"
  },
  "headline": "Implement Reuseable <img/>",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://woody-morgan.github.io//static/images/img.jpeg"
    }
  ],
  "datePublished": "2022-08-01T00:00:00.000Z",
  "dateModified": "2022-08-01T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Kim, Dong-Wook"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "woody morgan",
    "logo": {
      "@type": "ImageObject",
      "url": "https://woody-morgan.github.io//static/images/logo.png"
    }
  },
  "description": "CLS(Cumulative Layout Shift)를 줄이고 렌더링 성능을 개선한 <img/> 컴포넌트 제작기"
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/35c5c6636e0e5fd1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/35c5c6636e0e5fd1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-7b5e3b538b1441e1.js" defer=""></script><script src="/_next/static/chunks/main-63e2e8f7580e9625.js" defer=""></script><script src="/_next/static/chunks/pages/_app-31861f84ad26bbcb.js" defer=""></script><script src="/_next/static/chunks/860-5d67c27e6b591244.js" defer=""></script><script src="/_next/static/chunks/800-b0aa0e93ac41918c.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-f0fe9f9fb583fc8f.js" defer=""></script><script src="/_next/static/O-m_DCT8MRpr8DDbpzLQJ/_buildManifest.js" defer=""></script><script src="/_next/static/O-m_DCT8MRpr8DDbpzLQJ/_ssgManifest.js" defer=""></script><script src="/_next/static/O-m_DCT8MRpr8DDbpzLQJ/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Inspirations" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" class="flex text-gray-900 dark:text-gray-100" viewBox="0 0 128 128" width="48" height="48" fill="currentColor"><g transform="translate(0.000000,132.000000) scale(0.100000,-0.100000)"><path d="M523 1126 c-181 -44 -334 -202 -372 -384 -35 -166 15 -330 138 -453 199 -199 503 -199 702 0 199 199 199 503 0 702 -126 126 -299 176 -468 135z m259 -57 c191 -64 308 -227 308 -429 0 -256 -194 -450 -450 -450 -256 0 -450 194 -450 450 0 200 116 364 305 429 82 28 204 28 287 0z"></path><path d="M533 1006 c-104 -34 -194 -114 -241 -214 -23 -49 -27 -70 -27 -152 0 -87 3 -101 32 -161 39 -80 111 -150 191 -187 49 -23 70 -27 152 -27 87 0 101 3 161 32 80 39 150 111 187 191 23 49 27 70 27 152 0 82 -4 103 -27 152 -37 79 -108 152 -185 190 -54 26 -79 32 -146 35 -51 2 -98 -2 -124 -11z m89 -93 c2 -44 7 -58 18 -58 11 0 16 14 18 58 3 53 5 57 27 57 53 0 136 -42 190 -95 53 -54 95 -137 95 -190 0 -22 -4 -24 -57 -27 -44 -2 -58 -7 -58 -18 0 -11 14 -16 58 -18 53 -3 57 -5 57 -27 0 -53 -42 -136 -95 -190 -54 -53 -137 -95 -190 -95 -22 0 -24 4 -27 58 -2 43 -7 57 -18 57 -11 0 -16 -14 -18 -57 -3 -54 -5 -58 -27 -58 -53 0 -136 42 -190 95 -53 54 -95 137 -95 190 0 22 4 24 58 27 43 2 57 7 57 18 0 11 -14 16 -57 18 -54 3 -58 5 -58 27 0 13 9 50 21 80 38 103 166 203 261 204 26 1 27 -1 30 -56z"></path><path d="M664 839 c-8 -13 12 -32 64 -61 17 -9 42 -35 57 -58 26 -42 47 -48 53 -16 11 57 -146 180 -174 135z"></path><path d="M513 754 c-3 -9 5 -26 21 -43 19 -20 26 -38 26 -67 0 -54 31 -84 86 -84 33 0 46 -7 74 -35 37 -38 70 -46 70 -17 0 10 -16 33 -35 52 -29 28 -35 41 -35 75 0 55 -31 85 -86 85 -30 0 -47 6 -64 25 -27 29 -48 32 -57 9z m157 -89 c26 -32 -13 -81 -47 -59 -35 22 -23 74 17 74 10 0 23 -7 30 -15z"></path></g></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Inspirations</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/projects">Projects</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100" opacity="0"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-24 right-0 z-[1000] h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed h-full w-full cursor-auto focus:outline-none"></button><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">Projects</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div style="opacity:1"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-08-01T00:00:00.000Z">2022년 8월 1일 월요일</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Implement Reuseable &lt;img/&gt;</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="/static/images/avatar.jpeg" width="38px" height="38px" alt="avatar" class="h-10 w-10 rounded-full"/><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Kim, Dong-Wook</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><details open=""><summary class="ml-6 pt-2 pb-2 text-xl font-bold">Table of Contents</summary><div class="ml-6"><ul><li class="false"><a href="#why-we-need-new-image-component">Why we need new Image component?</a></li><li class="false"><a href="#how-to-implement-new-image-component">How to implement new Image component?</a></li><li class="false"><a href="#properties-of-new-image-component">Properties of new Image component</a></li><li class="ml-6"><a href="#1-load-when-browser-intersects-viewport">1. Load when Browser Intersects Viewport</a></li><li class="ml-6"><a href="#2-support-cls-preventionactually-buggy">2. Support CLS prevention(actually buggy)</a></li><li class="ml-6"><a href="#3-support-responsive-attribute">3. Support Responsive Attribute</a></li><li class="ml-6"><a href="#4-full-code">4. Full Code</a></li><li class="false"><a href="#conclusion">Conclusion</a></li></ul></div></details><h2 id="intro"><a href="#intro" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Intro</h2><p>While studying React, I want to implement a new lazy loadable image component. I usually run a project with Next.js. Next.js provides NextImage as a default image component. It supports not only lazy loading and also CLS prevention. But in React, there is no such feature. So I decided to implement my own image component that supports these properties. In this article, I will share the experience while making this.</p><h2 id="why-we-need-new-image-component"><a href="#why-we-need-new-image-component" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Why we need new Image component?</h2><p>Normal html image tag has a lot of problem. <code>First</code>, it is not responsive. We need to add &#x27;max-width&#x27; to make it responsive. <code>Second</code>, it loads all images in DOM. Imagine a situation where the website has a lot of images, and it takes 10 or more seconds to load all the images. The user will see a lot of blank spaces in the screen. <code>Third</code>, it is not CLS prevention. If the user does not provide a width and height, the browser will recalculate the width and height of the image right after the image is loaded. It leads to a wrong layout which is a.k.a. <code>Cumulative Layout Shift</code> problem.</p><h2 id="how-to-implement-new-image-component"><a href="#how-to-implement-new-image-component" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>How to implement new Image component?</h2><p>Actually NextImage already solved all these problems.Even supports CDN(Content Delivery Network) optimized image delivery. If you want to use NextImage, learn Next.js and use it.</p><p>But I want to implement my own image component.</p><h2 id="properties-of-new-image-component"><a href="#properties-of-new-image-component" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Properties of new Image component</h2><p>These are features of new Image component.</p><ol><li>Load when Browser Intersects Viewport</li><li>Support CLS prevention(actually buggy)</li><li>Support Responsive Attribute</li></ol><p>I want to support CDN optimized image delivery. But I don&#x27;t know how to do it. If you know(using Akamai, Cloudflare, etc.), please let me know.</p><h3 id="1-load-when-browser-intersects-viewport"><a href="#1-load-when-browser-intersects-viewport" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>1. Load when Browser Intersects Viewport</h3><p>The way to implement this is using Intersection Observer API. When the component is mounted in react rendering tree, the browser will start observing the Image element. When the Image element intersect with viewport, the browser will execute the callback function. In this case, we set the isLoad variable to true. Then the image will start loading. The advantage of this is that the image will be loaded when the user see it. So it leads to lower network usage when it first appears.</p><div class="remark-code-title">MyCustomImage.tsx</div><div class="relative"><pre><code class="language-jsx code-highlight"><span class="code-line"><span class="token keyword">const</span> <span class="token maybe-class-name">Image</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ImageWrapperProps</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = ({
</span></span><span class="code-line"><span class="token plain-text">  src,
</span></span><span class="code-line"><span class="token plain-text">  width,
</span></span><span class="code-line"><span class="token plain-text">  height,
</span></span><span class="code-line"><span class="token plain-text">  alt,
</span></span><span class="code-line"><span class="token plain-text">  className,
</span></span><span class="code-line"><span class="token plain-text">}) =&gt; </span><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> imgRef <span class="token operator">=</span> useRef<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">HTMLImageElement</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(null);
</span></span><span class="code-line"><span class="token plain-text">  const observerRef = useRef</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">IntersectionObserver</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">();
</span></span><span class="code-line"><span class="token plain-text">  const [isLoad, setIsLoad] = useState(false);
</span></span><span class="code-line"><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  function onIntersection(
</span></span><span class="code-line"><span class="token plain-text">    entries: IntersectionObserverEntry[],
</span></span><span class="code-line"><span class="token plain-text">    io: IntersectionObserver,
</span></span><span class="code-line"><span class="token plain-text">  ) </span><span class="token punctuation">{</span>
</span><span class="code-line">    entries<span class="token punctuation">.</span><span class="token property-access function method">forEach</span><span class="token punctuation">(</span><span class="token parameter">entry</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token property-access">isIntersecting</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        io<span class="token punctuation">.</span><span class="token property-access function method">unobserve</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">setIsLoad</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  useEffect(() =&gt; </span><span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>observerRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      observerRef<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>onIntersection<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    imgRef<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">&amp;&amp;</span> observerRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token operator">?.</span><span class="token property-access function method">observe</span><span class="token punctuation">(</span>imgRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token plain-text">, []);
</span></span><span class="code-line"><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  return (
</span></span><span class="code-line"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">ref</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>imgRef<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">width</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>width<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">height</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>height<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">src</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>isLoad <span class="token operator">?</span> src <span class="token operator">:</span> <span class="token keyword nil">undefined</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">alt</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>alt<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">    <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  );
</span></span><span class="code-line"><span class="token plain-text">};
</span></span></code></pre></div><p><img alt="intersect-but-CLSed" src="https://d.pr/i/H7Ukc7.gif"/></p><p>Now the Image component supports loading when the user sees it. But it still has a problem. CLS is happening. As you can see above, browser recalculates the width and height of the image right after the image is loaded. It makes the performance of the website slow &amp; cause wrong layout. We can solve this problem by adding custom <code>placeHolder</code> image which is shown before the image is loaded.</p><h3 id="2-support-cls-preventionactually-buggy"><a href="#2-support-cls-preventionactually-buggy" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>2. Support CLS prevention(actually buggy)</h3><p>To solve this problem, we can add a placeHolder image when it is not loaded. Image component should be given the width and height of the image. So use this props, we show the svg placeholder image.</p><div class="remark-code-title">MyCustomImage.tsx</div><div class="relative"><pre><code class="language-jsx code-highlight"><span class="code-line">
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function function-variable">placeholderSrc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">width<span class="token operator">:</span> number<span class="token punctuation">,</span> height<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span>
</span><span class="code-line">  <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">data:image/svg+xml,%3Csvg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 </span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>width<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>height<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">&quot;%3E%3C/svg%3E</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token maybe-class-name">Image</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ImageWrapperProps</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = ({
</span></span><span class="code-line"><span class="token plain-text">  src,
</span></span><span class="code-line"><span class="token plain-text">  width,
</span></span><span class="code-line"><span class="token plain-text">  height,
</span></span><span class="code-line"><span class="token plain-text">  alt,
</span></span><span class="code-line"><span class="token plain-text">  className,
</span></span><span class="code-line"><span class="token plain-text">}) =&gt; </span><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token operator spread">...</span>same <span class="token keyword module">as</span> above
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">ref</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>imgRef<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">width</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>width<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">height</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>height<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">src</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>isLoad <span class="token operator">?</span> src <span class="token operator">:</span> <span class="token function">placeholderSrc</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">alt</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>alt<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">    <span class="token punctuation">/&gt;</span></span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token plain-text">;
</span></span><span class="code-line"><span class="token plain-text">
</span></span></code></pre></div><p>So when the image is not loaded, browser already knows the actual width and height of the image. So it will not recalculate the width and height of the image.(But actually, it differs by CSS Property...)</p><h3 id="3-support-responsive-attribute"><a href="#3-support-responsive-attribute" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>3. Support Responsive Attribute</h3><p>NextImage provides &quot;responsive&quot; | &quot;fixed&quot; | &quot;fill&quot; | &quot;intrinsic&quot; attribute. We will implement &quot;responsive&quot; and &quot;fill&quot; attribute. For &quot;responsive&quot;, the height of the image will be calculated by the width of the image. So, set max of the width is 100% of the parent element &amp; the height is auto. Then the height is decreased and increased by the width of the parent element. For &quot;fill&quot;, the image will be filled the whole parent container. Both width and height are 100% of the parent element. But the image will be cropped. So we need to give objectFit property to the image so user can see the image correctly.</p><div class="remark-code-title">MyCustomImage.tsx</div><div class="relative"><pre><code class="language-jsx code-highlight"><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token maybe-class-name">Image</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ImageWrapperProps</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = (</span><span class="token punctuation">{</span>
</span><span class="code-line">  src<span class="token punctuation">,</span>
</span><span class="code-line">  width<span class="token punctuation">,</span>
</span><span class="code-line">  height<span class="token punctuation">,</span>
</span><span class="code-line">  alt<span class="token punctuation">,</span>
</span><span class="code-line">  layout <span class="token operator">=</span> <span class="token string">&#x27;responsive&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">  objectFit <span class="token operator">=</span> <span class="token string">&#x27;cover&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">  className<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token plain-text">) =&gt; </span><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token operator spread">...</span>same <span class="token keyword module">as</span> above
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">className</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span><span class="token function">cx</span><span class="token punctuation">(</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">        <span class="token string">&#x27;bg-none outline-none&#x27;</span><span class="token punctuation">,</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">        layout <span class="token operator">===</span> <span class="token string">&#x27;fill&#x27;</span> <span class="token operator">?</span> <span class="token string">&#x27;w-full h-full&#x27;</span> <span class="token operator">:</span> <span class="token string">&#x27;max-w-full h-auto&#x27;</span><span class="token punctuation">,</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">        objectFit <span class="token operator">===</span> <span class="token string">&#x27;contain&#x27;</span> <span class="token operator">?</span> <span class="token string">&#x27;object-contain&#x27;</span> <span class="token operator">:</span> <span class="token string">&#x27;object-cover&#x27;</span><span class="token punctuation">,</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">        className<span class="token punctuation">,</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">      <span class="token punctuation">)</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">ref</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>imgRef<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">width</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>width<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">height</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>height<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">src</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>isLoad <span class="token operator">?</span> src <span class="token operator">:</span> <span class="token function">placeholderSrc</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">alt</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>alt<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">    <span class="token punctuation">/&gt;</span></span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token plain-text">;
</span></span><span class="code-line"><span class="token plain-text">
</span></span></code></pre></div><p><img alt="responsive-image" src="https://d.pr/i/ZsJcTY.gif"/></p><h4 id="4-full-code"><a href="#4-full-code" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>4. Full Code</h4><div class="remark-code-title">MyCustomImage.tsx</div><div class="relative"><pre><code class="language-jsx code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token punctuation">{</span> <span class="token constant">FC</span><span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">cx</span> <span class="token keyword module">from</span> <span class="token string">&#x27;classnames&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function function-variable">placeholderSrc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">width<span class="token operator">:</span> number<span class="token punctuation">,</span> height<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span>
</span><span class="code-line">  <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">data:image/svg+xml,%3Csvg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 </span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>width<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>height<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">&quot;%3E%3C/svg%3E</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword module">export</span> type <span class="token maybe-class-name">ImageWrapperProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  src<span class="token operator">:</span> string<span class="token punctuation">;</span>
</span><span class="code-line">  width<span class="token operator">:</span> number<span class="token punctuation">;</span>
</span><span class="code-line">  height<span class="token operator">:</span> number<span class="token punctuation">;</span>
</span><span class="code-line">  alt<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
</span><span class="code-line">  layout<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#x27;fill&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;responsive&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">  objectFit<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#x27;contain&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;cover&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">  className<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token maybe-class-name">Image</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ImageWrapperProps</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = (</span><span class="token punctuation">{</span>
</span><span class="code-line">  src<span class="token punctuation">,</span>
</span><span class="code-line">  width<span class="token punctuation">,</span>
</span><span class="code-line">  height<span class="token punctuation">,</span>
</span><span class="code-line">  alt<span class="token punctuation">,</span>
</span><span class="code-line">  layout <span class="token operator">=</span> <span class="token string">&#x27;responsive&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">  objectFit <span class="token operator">=</span> <span class="token string">&#x27;cover&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">  className<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token plain-text">) =&gt; </span><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> imgRef <span class="token operator">=</span> useRef<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">HTMLImageElement</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(null);
</span></span><span class="code-line"><span class="token plain-text">  const observerRef = useRef</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">IntersectionObserver</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">();
</span></span><span class="code-line"><span class="token plain-text">  const [isLoad, setIsLoad] = useState(false);
</span></span><span class="code-line"><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  function onIntersection(
</span></span><span class="code-line"><span class="token plain-text">    entries: IntersectionObserverEntry[],
</span></span><span class="code-line"><span class="token plain-text">    io: IntersectionObserver,
</span></span><span class="code-line"><span class="token plain-text">  ) </span><span class="token punctuation">{</span>
</span><span class="code-line">    entries<span class="token punctuation">.</span><span class="token property-access function method">forEach</span><span class="token punctuation">(</span><span class="token parameter">entry</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token property-access">isIntersecting</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        io<span class="token punctuation">.</span><span class="token property-access function method">unobserve</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">setIsLoad</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  useEffect(() =&gt; </span><span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>observerRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      observerRef<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>onIntersection<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    imgRef<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">&amp;&amp;</span> observerRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token operator">?.</span><span class="token property-access function method">observe</span><span class="token punctuation">(</span>imgRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token plain-text">, []);
</span></span><span class="code-line"><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  return (
</span></span><span class="code-line"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">className</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span><span class="token function">cx</span><span class="token punctuation">(</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">        <span class="token string">&#x27;bg-none outline-none&#x27;</span><span class="token punctuation">,</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">        layout <span class="token operator">===</span> <span class="token string">&#x27;fill&#x27;</span> <span class="token operator">?</span> <span class="token string">&#x27;w-full h-full&#x27;</span> <span class="token operator">:</span> <span class="token string">&#x27;max-w-full h-auto&#x27;</span><span class="token punctuation">,</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">        objectFit <span class="token operator">===</span> <span class="token string">&#x27;contain&#x27;</span> <span class="token operator">?</span> <span class="token string">&#x27;object-contain&#x27;</span> <span class="token operator">:</span> <span class="token string">&#x27;object-cover&#x27;</span><span class="token punctuation">,</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">        className<span class="token punctuation">,</span>
</span></span></span><span class="code-line"><span class="token tag"><span class="token language-javascript script">      <span class="token punctuation">)</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">ref</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>imgRef<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">width</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>width<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">height</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>height<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">src</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>isLoad <span class="token operator">?</span> src <span class="token operator">:</span> <span class="token function">placeholderSrc</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">alt</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>alt<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">    <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  );
</span></span><span class="code-line"><span class="token plain-text">};
</span></span><span class="code-line"><span class="token plain-text">export default Image;
</span></span><span class="code-line"><span class="token plain-text">
</span></span></code></pre></div><h2 id="conclusion"><a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Conclusion</h2><ol><li><p>Browser Intersection Observer API is a great tool to optimize the performance of the website. But too much use of it can cause the performance of the website slow. So we need to use it carefully.</p></li><li><p>SVG could be a good choice to use as a placeholder image.</p></li><li><p>Production ready image component need to have more optimizing features.</p></li></ol></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="noopener noreferrer" href="https://github.com/woody-morgan/woody-morgan.github.io/blob/master/data/blog/frontend/implement-reflow-prevented-lazy-loading-image-component.mdx">View on GitHub</a></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/frontend">frontend</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/frontend/making-full-page-scroll-effect">How to Apply Full Page Scroll Effect</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/backend/deploy-nestjs-application-on-heroku-system">Deploy Nestjs Application on Heroku</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/woody-morgan"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/woody-morgan"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>woody morgan</div><div> • </div><div>© 2024</div><div> • </div><a href="/">woody-morgan.github.io</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var p=Object.create;var t=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=\u003et(a,\"__esModule\",{value:!0});var N=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=\u003e{i(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},g=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of h(s))!u.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026t(a,n,{get:()=\u003es[n],enumerable:!(c=d(s,n))||c.enumerable});return a},w=a=\u003eg(i(t(a!=null?p(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((j,o)=\u003e{o.exports=_jsx_runtime});var b={};k(b,{default:()=\u003ev,frontmatter:()=\u003ef});var e=w(r()),f={title:\"Implement Reuseable \u003cimg/\u003e\",date:new Date(1659312e6),tags:[\"frontend\"],draft:!1,summary:\"CLS(Cumulative Layout Shift)\\uB97C \\uC904\\uC774\\uACE0 \\uB80C\\uB354\\uB9C1 \\uC131\\uB2A5\\uC744 \\uAC1C\\uC120\\uD55C \u003cimg/\u003e \\uCEF4\\uD3EC\\uB10C\\uD2B8 \\uC81C\\uC791\\uAE30\",images:[\"/static/images/img.jpeg\"],layout:\"PostLayout\"};function x(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",code:\"code\",ol:\"ol\",li:\"li\",h3:\"h3\",pre:\"pre\",img:\"img\",h4:\"h4\"},a.components),{TOCInline:l}=n;return l||y(\"TOCInline\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l,{toc:a.toc,exclude:\"Intro\",asDisclosure:!0}),(0,e.jsxs)(n.h2,{id:\"intro\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#intro\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Intro\"]}),(0,e.jsx)(n.p,{children:\"While studying React, I want to implement a new lazy loadable image component. I usually run a project with Next.js. Next.js provides NextImage as a default image component. It supports not only lazy loading and also CLS prevention. But in React, there is no such feature. So I decided to implement my own image component that supports these properties. In this article, I will share the experience while making this.\"}),(0,e.jsxs)(n.h2,{id:\"why-we-need-new-image-component\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#why-we-need-new-image-component\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Why we need new Image component?\"]}),(0,e.jsxs)(n.p,{children:[\"Normal html image tag has a lot of problem. \",(0,e.jsx)(n.code,{children:\"First\"}),\", it is not responsive. We need to add 'max-width' to make it responsive. \",(0,e.jsx)(n.code,{children:\"Second\"}),\", it loads all images in DOM. Imagine a situation where the website has a lot of images, and it takes 10 or more seconds to load all the images. The user will see a lot of blank spaces in the screen. \",(0,e.jsx)(n.code,{children:\"Third\"}),\", it is not CLS prevention. If the user does not provide a width and height, the browser will recalculate the width and height of the image right after the image is loaded. It leads to a wrong layout which is a.k.a. \",(0,e.jsx)(n.code,{children:\"Cumulative Layout Shift\"}),\" problem.\"]}),(0,e.jsxs)(n.h2,{id:\"how-to-implement-new-image-component\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#how-to-implement-new-image-component\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"How to implement new Image component?\"]}),(0,e.jsx)(n.p,{children:\"Actually NextImage already solved all these problems.Even supports CDN(Content Delivery Network) optimized image delivery. If you want to use NextImage, learn Next.js and use it.\"}),(0,e.jsx)(n.p,{children:\"But I want to implement my own image component.\"}),(0,e.jsxs)(n.h2,{id:\"properties-of-new-image-component\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#properties-of-new-image-component\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Properties of new Image component\"]}),(0,e.jsx)(n.p,{children:\"These are features of new Image component.\"}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:\"Load when Browser Intersects Viewport\"}),(0,e.jsx)(n.li,{children:\"Support CLS prevention(actually buggy)\"}),(0,e.jsx)(n.li,{children:\"Support Responsive Attribute\"})]}),(0,e.jsx)(n.p,{children:\"I want to support CDN optimized image delivery. But I don't know how to do it. If you know(using Akamai, Cloudflare, etc.), please let me know.\"}),(0,e.jsxs)(n.h3,{id:\"1-load-when-browser-intersects-viewport\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#1-load-when-browser-intersects-viewport\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. Load when Browser Intersects Viewport\"]}),(0,e.jsx)(n.p,{children:\"The way to implement this is using Intersection Observer API. When the component is mounted in react rendering tree, the browser will start observing the Image element. When the Image element intersect with viewport, the browser will execute the callback function. In this case, we set the isLoad variable to true. Then the image will start loading. The advantage of this is that the image will be loaded when the user see it. So it leads to lower network usage when it first appears.\"}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"MyCustomImage.tsx\"}),(0,e.jsx)(n.pre,{className:\"language-jsx\",children:(0,e.jsxs)(n.code,{className:\"language-jsx code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Image\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token constant\",children:\"FC\"}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"ImageWrapperProps\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:` = ({\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  src,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  width,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  height,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  alt,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  className,\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"}) =\u003e \"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" imgRef \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" useRef\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"HTMLImageElement\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`(null);\n`})]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"  const observerRef = useRef\"}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"IntersectionObserver\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`();\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  const [isLoad, setIsLoad] = useState(false);\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  function onIntersection(\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`    entries: IntersectionObserverEntry[],\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`    io: IntersectionObserver,\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"  ) \"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    entries\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"forEach\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"entry\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"entry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"isIntersecting\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"unobserve\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"entry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"target\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setIsLoad\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"  useEffect(() =\u003e \"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"observerRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      observerRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"IntersectionObserver\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"onIntersection\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    imgRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" observerRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"?.\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"observe\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"imgRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`, []);\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  return (\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"    \"}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"img\"]}),`\n`]})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"ref\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"imgRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"width\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"height\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"src\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"isLoad \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" src \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword nil\",children:\"undefined\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"alt\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"/\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  );\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`};\n`})})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"intersect-but-CLSed\",src:\"https://d.pr/i/H7Ukc7.gif\"})}),(0,e.jsxs)(n.p,{children:[\"Now the Image component supports loading when the user sees it. But it still has a problem. CLS is happening. As you can see above, browser recalculates the width and height of the image right after the image is loaded. It makes the performance of the website slow \u0026 cause wrong layout. We can solve this problem by adding custom \",(0,e.jsx)(n.code,{children:\"placeHolder\"}),\" image which is shown before the image is loaded.\"]}),(0,e.jsxs)(n.h3,{id:\"2-support-cls-preventionactually-buggy\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#2-support-cls-preventionactually-buggy\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"2. Support CLS prevention(actually buggy)\"]}),(0,e.jsx)(n.p,{children:\"To solve this problem, we can add a placeHolder image when it is not loaded. Image component should be given the width and height of the image. So use this props, we show the svg placeholder image.\"}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"MyCustomImage.tsx\"}),(0,e.jsx)(n.pre,{className:\"language-jsx\",children:(0,e.jsxs)(n.code,{className:\"language-jsx code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"export\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token function function-variable\",children:\"placeholderSrc\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token parameter\",children:[\"width\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" number\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" height\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" number\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:\" \"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"height\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"%3E%3C/svg%3E'}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Image\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token constant\",children:\"FC\"}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"ImageWrapperProps\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:` = ({\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  src,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  width,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  height,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  alt,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  className,\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"}) =\u003e \"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token operator spread\",children:\"...\"}),\"same \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"as\"}),` above\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"img\"]}),`\n`]})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"ref\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"imgRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"width\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"height\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"src\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"isLoad \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" src \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"placeholderSrc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"alt\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"/\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`;\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})})]})}),(0,e.jsx)(n.p,{children:\"So when the image is not loaded, browser already knows the actual width and height of the image. So it will not recalculate the width and height of the image.(But actually, it differs by CSS Property...)\"}),(0,e.jsxs)(n.h3,{id:\"3-support-responsive-attribute\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#3-support-responsive-attribute\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"3. Support Responsive Attribute\"]}),(0,e.jsx)(n.p,{children:'NextImage provides \"responsive\" | \"fixed\" | \"fill\" | \"intrinsic\" attribute. We will implement \"responsive\" and \"fill\" attribute. For \"responsive\", the height of the image will be calculated by the width of the image. So, set max of the width is 100% of the parent element \u0026 the height is auto. Then the height is decreased and increased by the width of the parent element. For \"fill\", the image will be filled the whole parent container. Both width and height are 100% of the parent element. But the image will be cropped. So we need to give objectFit property to the image so user can see the image correctly.'}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"MyCustomImage.tsx\"}),(0,e.jsx)(n.pre,{className:\"language-jsx\",children:(0,e.jsxs)(n.code,{className:\"language-jsx code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Image\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token constant\",children:\"FC\"}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"ImageWrapperProps\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:\" = (\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  src\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  layout \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'responsive'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  objectFit \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cover'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  className\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:\") =\u003e \"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token operator spread\",children:\"...\"}),\"same \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"as\"}),` above\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"img\"]}),`\n`]})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"className\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"cx\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'bg-none outline-none'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"        layout \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"===\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'fill'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'w-full h-full'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'max-w-full h-auto'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"        objectFit \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"===\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'contain'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'object-contain'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'object-cover'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"        className\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"ref\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"imgRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"width\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"height\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"src\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"isLoad \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" src \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"placeholderSrc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"alt\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"/\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`;\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"responsive-image\",src:\"https://d.pr/i/ZsJcTY.gif\"})}),(0,e.jsxs)(n.h4,{id:\"4-full-code\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#4-full-code\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"4. Full Code\"]}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"MyCustomImage.tsx\"}),(0,e.jsx)(n.pre,{className:\"language-jsx\",children:(0,e.jsxs)(n.code,{className:\"language-jsx code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,e.jsx)(n.span,{className:\"token constant\",children:\"FC\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" useEffect\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" useRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" useState \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'react'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token imports\",children:\"cx\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'classnames'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"export\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token function function-variable\",children:\"placeholderSrc\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token parameter\",children:[\"width\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" number\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" height\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" number\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:\" \"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"height\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"%3E%3C/svg%3E'}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"export\"}),\" type \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ImageWrapperProps\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  src\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" string\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  width\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" number\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  height\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" number\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  alt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" string\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  layout\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'fill'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'responsive'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  objectFit\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'contain'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cover'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  className\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" string\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Image\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token constant\",children:\"FC\"}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"ImageWrapperProps\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:\" = (\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  src\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  layout \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'responsive'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  objectFit \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cover'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  className\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:\") =\u003e \"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" imgRef \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" useRef\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"HTMLImageElement\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`(null);\n`})]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"  const observerRef = useRef\"}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"IntersectionObserver\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`();\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  const [isLoad, setIsLoad] = useState(false);\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  function onIntersection(\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`    entries: IntersectionObserverEntry[],\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`    io: IntersectionObserver,\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"  ) \"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    entries\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"forEach\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"entry\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"entry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"isIntersecting\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"unobserve\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"entry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"target\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setIsLoad\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"  useEffect(() =\u003e \"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"observerRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      observerRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"IntersectionObserver\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"onIntersection\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    imgRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" observerRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"?.\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"observe\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"imgRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"current\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`, []);\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  return (\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token plain-text\",children:\"    \"}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"img\"]}),`\n`]})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"className\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"cx\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'bg-none outline-none'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"        layout \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"===\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'fill'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'w-full h-full'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'max-w-full h-auto'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"        objectFit \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"===\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'contain'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'object-contain'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'object-cover'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"        className\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"ref\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"imgRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"width\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"height\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"src\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"isLoad \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" src \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"placeholderSrc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"alt\"}),(0,e.jsxs)(n.span,{className:\"token language-javascript script\",children:[(0,e.jsx)(n.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"/\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`  );\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`};\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`export default Image;\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token plain-text\",children:`\n`})})]})}),(0,e.jsxs)(n.h2,{id:\"conclusion\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#conclusion\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:(0,e.jsx)(n.p,{children:\"Browser Intersection Observer API is a great tool to optimize the performance of the website. But too much use of it can cause the performance of the website slow. So we need to use it carefully.\"})}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.p,{children:\"SVG could be a good choice to use as a placeholder image.\"})}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.p,{children:\"Production ready image component need to have more optimizing features.\"})})]})]})}}var v=x;function y(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return b;})();\n;return Component;","toc":[{"value":"Intro","url":"#intro","depth":2},{"value":"Why we need new Image component?","url":"#why-we-need-new-image-component","depth":2},{"value":"How to implement new Image component?","url":"#how-to-implement-new-image-component","depth":2},{"value":"Properties of new Image component","url":"#properties-of-new-image-component","depth":2},{"value":"1. Load when Browser Intersects Viewport","url":"#1-load-when-browser-intersects-viewport","depth":3},{"value":"2. Support CLS prevention(actually buggy)","url":"#2-support-cls-preventionactually-buggy","depth":3},{"value":"3. Support Responsive Attribute","url":"#3-support-responsive-attribute","depth":3},{"value":"4. Full Code","url":"#4-full-code","depth":4},{"value":"Conclusion","url":"#conclusion","depth":2}],"frontMatter":{"readingTime":{"text":"10 min read","minutes":9.665,"time":579900,"words":1933},"slug":"frontend/implement-reflow-prevented-lazy-loading-image-component","fileName":"frontend/implement-reflow-prevented-lazy-loading-image-component.mdx","title":"Implement Reuseable \u003cimg/\u003e","date":"2022-08-01T00:00:00.000Z","tags":["frontend"],"draft":false,"summary":"CLS(Cumulative Layout Shift)를 줄이고 렌더링 성능을 개선한 \u003cimg/\u003e 컴포넌트 제작기","images":["/static/images/img.jpeg"],"layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.285,"time":17100,"words":57},"slug":["default"],"fileName":"default.mdx","name":"Kim, Dong-Wook","avatar":"/static/images/avatar.jpeg","occupation":"Frontend Developer","company":"Krafton Inc.","email":"woody.morgan.crafts@gmail.com","linkedin":"https://www.linkedin.com/in/woody-morgan/","github":"https://github.com/woody-morgan","date":null}],"prev":{"title":"How to Apply Full Page Scroll Effect","date":"2022-07-30T00:00:00.000Z","tags":["frontend"],"draft":false,"summary":"Full Page Scroll Effect 만들면서 생긴 이슈들을 정리해보았습니다.","images":["/static/images/javascript.png"],"layout":"PostLayout","slug":"frontend/making-full-page-scroll-effect"},"next":{"title":"Deploy Nestjs Application on Heroku","date":"2022-08-07T00:00:00.000Z","tags":["backend"],"draft":false,"summary":"Nestjs 어플리케이션을 배포하면서 생긴 문제점을 정리하였습니다","images":["/static/images/heroku-nestjs.webp"],"layout":"PostLayout","slug":"backend/deploy-nestjs-application-on-heroku-system"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["frontend","implement-reflow-prevented-lazy-loading-image-component"]},"buildId":"O-m_DCT8MRpr8DDbpzLQJ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>